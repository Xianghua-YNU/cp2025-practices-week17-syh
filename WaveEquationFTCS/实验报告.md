# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** [姓名] **学号：** [学号] **完成日期：** [日期]

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# 计算第一个时间步 u(x, 1) 的值
psi = u_t(x, C, d, sigma, L)
u[:, 1] = psi * dt  # 简化形式，因为 u(x, 0) = 0

# 使用FTCS方案迭代计算后续时间步的解
for j in range(1, nt - 1):
    # 内部点更新
    for i in range(1, nx - 1):
        u[i, j + 1] = c * (u[i + 1, j] + u[i - 1, j]) + 2 * (1 - c) * u[i, j] - u[i, j - 1]
    
    # 边界条件处理
    u[0, j + 1] = 0  # 左边界
    u[-1, j + 1] = 0  # 右边界
```

## 3. 实验结果

### 3.1 主要输出

通过代码运行，得到了弦振动的动态模拟动画（基于 matplotlib.animation.FuncAnimation 创建 ）。从输出的静态图形（如题目中给出的截图）来看，展示了某一时刻弦的位移随位置的变化情况。弦的位移在 0 点两侧波动，呈现出特定的曲线形态，反映了弦在该时刻的振动形状。动画则能连续展示弦随时间推移，振动形态从初始状态逐渐变化、传播的过程。
![5-1](https://github.com/user-attachments/assets/a2eff6b6-f9fd-4e71-9070-870a96712c99)


### 3.2 结果验证

边界条件验证：在模拟过程中，通过代码 u[0, j + 1] = 0 和 u[-1, j + 1] = 0 严格设置边界条件，并且从输出结果（包括动画和中间数据查看）可知，弦的两端（位置 0 和位置 1m 处 ）位移始终保持为 0，满足边界条件要求。

波形合理性验证：初始速度剖面为特定的函数形式，模拟得到的弦振动波形符合波动传播的预期。随着时间推移，波形按照波动方程所描述的规律传播、变化，未出现明显的不合理畸变。

数值稳定性验证：计算稳定性条件 \(c = (v\frac{\Delta t}{\Delta x})^2\) ，本实验中参数设置计算得到的 c 小于 1（经代码中稳定性条件检查代码验证 ），模拟过程中数值解未出现发散情况，保证了数值稳定性。

## 4. 问题与收获

### 4.1 主要问题

初始速度条件处理：在实验初期，对于如何根据给定的初始速度剖面函数，准确计算第一个时间步的弦位移，理解不够清晰，不清楚简化公式的应用条件和推导逻辑。

动画制作挑战：在使用 matplotlib.animation.FuncAnimation 创建动画时，对于更新函数的编写、动画参数（如 interval ）的设置以及如何确保动画流畅展示弦振动过程，存在较多困惑，不知道如何合理调整参数以得到清晰直观的动画效果。

### 4.2 解决方法

初始速度条件处理：通过查阅计算物理教材中关于有限差分法求解波动方程初始条件处理的相关内容，深入理解初始速度离散化的原理，结合本实验中初始位移为 0 的条件，明确简化公式 \(u_{i,1}=\psi(x_i)\Delta t\) 的应用依据，从而正确实现第一个时间步位移的计算。

动画制作挑战：仔细学习 Matplotlib 官方文档中关于动画模块的使用说明，参考示例代码，理解更新函数的工作机制。通过多次调整 interval 等参数，结合对弦振动频率和模拟时间步长的分析，确定合适的参数值，最终实现了弦振动过程的清晰、流畅动画展示。

### 4.3 主要收获

加深了对一维波动方程物理意义的理解，以及有限差分法（FTCS 方案）数值求解波动方程原理的掌握，清晰认识到离散化过程、初始条件和边界条件在数值模拟中的关键作用。

熟练掌握了使用 Python 的 NumPy 库进行高效数值计算，利用 Matplotlib 库进行数据可视化和动画制作的技能，能够将数值模拟结果以直观的图形和动画形式呈现。

深刻认识到数值模拟中稳定性条件（如本实验中 \(c < 1\) 要求 ）的重要性，明白其对数值解收敛性和模拟结果合理性的影响，学会在实验中通过参数调整来满足稳定性要求。

## 5. 思考题（可选）

1.  如果改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式会有什么变化？

初始速度剖面 \(\psi(x)\) 决定了弦初始时刻的振动激励。若改变其形状，比如将原本的高斯型分布改为三角型分布，弦的振动模式会相应改变。不同的初始速度分布会激发不同频率成分的波动，使得弦在振动过程中，各位置的位移变化规律、波形传播速度和形态等都会不同。例如，更集中的初始速度分布可能会激发更尖锐的波形，而分布较宽的初始速度可能导致波形更平缓地传播和变化。

2.  尝试使用不同的 $\Delta t$ 和 $\Delta x$ 值，观察数值解的稳定性和准确性如何受到影响。当 $c \ge 1$ 时会发生什么？

稳定性影响：当减小 \(\Delta x\) 或增大 \(\Delta t\) 时，可能导致 \(c = (v\frac{\Delta t}{\Delta x})^2\) 增大。若 \(c < 1\) ，数值解通常保持稳定；当 \(c\geq1\) 时，数值解会出现发散现象，模拟得到的弦位移会无限制地增大，无法得到合理的振动结果，这是因为此时 FTCS 方案的数值稳定性条件不满足，差分方程不能正确近似原波动方程的物理过程。

准确性影响：一般来说，减小 \(\Delta x\) 和 \(\Delta t\) （在满足稳定性条件下 ），数值解的准确性会提高，因为离散化的网格更细密，能更精确地逼近连续的波动方程。但同时，计算量会相应增加。若 \(\Delta x\) 过大或 \(\Delta t\) 过小（相对而言 ），可能会导致数值解出现误差，如波形畸变、传播速度不准确等情况，影响对弦振动真实物理过程的模拟。
