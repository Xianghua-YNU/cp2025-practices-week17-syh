# 项目：有限厚平行板电容器电荷分布分析 - 实验报告

**学生姓名：** [请填写姓名] **学号：** [请填写学号] **完成日期：** [请填写日期]

## 1. 实验目的

本实验旨在通过数值方法（SOR 迭代法）求解有限厚度平行板电容器的拉普拉斯方程，得到电势分布，进而计算电荷密度分布，深入理解有限厚度对平行板电容器电场、电荷分布的影响，掌握数值模拟求解静电场问题的方法 。

## 2. 核心算法

### 2.1 算法思路

SOR（Successive Over - Relaxation，逐次超松弛）迭代法用于求解拉普拉斯方程。首先初始化电势网格和导体掩码，确定极板（施加固定电势）和边界（接地）条件。然后进行迭代，对于每个内部非导体网格点，利用相邻点电势通过 SOR 更新公式U[i, j] = (1 - omega) * U[i, j] + omega * 0.25 * (U[i+1, j] + U[i-1, j] + U[i, j+1] + U[i, j-1])更新电势，跟踪最大误差，当误差小于收敛 tolerance 时停止迭代，得到电势分布。

### 2.2 关键代码片段

```python
# SOR iteration
for iteration in range(max_iter):
    U_old = U.copy()
    max_error = 0.0
    # Update interior points (excluding conductors and boundaries)
    for i in range(1, ny - 1):
        for j in range(1, nx - 1):
            if not conductor_mask[i, j]:  # Skip conductor points
                # SOR update formula
                U_new = 0.25 * (U[i + 1, j] + U[i - 1, j] + U[i, j + 1] + U[i, j - 1])
                U[i, j] = (1 - omega) * U[i, j] + omega * U_new
                # Track maximum error
                error = abs(U[i, j] - U_old[i, j])
                max_error = max(max_error, error)
    # Check convergence
    if max_error < tolerance:
        print(f"Converged after {iteration + 1} iterations")
        break
```

## 3. 实验结果

### 3.1 主要输出

程序输出显示，网格大小为 120 x 100，极板厚度 10 grid points，极板间距 40 grid points，SOR 松弛因子 1.9 时，迭代 237 次收敛，求解耗时 7.58 秒。电势最小值 - 100.00 V，最大值 100.00 V，范围 200.00 V 。电荷密度最大为 26342.265595，总正电荷与总负电荷绝对值相等（分别为 129.493936 和 - 129.493936 ），总电荷为 0，符合电荷守恒。从 3D 可视化图看，电势分布在极板间呈现预期的变化，电荷密度在极板边缘有明显集中（边缘效应）。

### 3.2 结果验证

边界条件检查：边界电势设置为 0，程序运行后边界电势确实为 0，符合接地边界条件；极板电势分别为 ±100 V，计算结果中极板区域电势正确。

物理合理性分析：电荷密度分布呈现极板处正负电荷分离，且总电荷守恒（总电荷接近 0 ），符合静电学基本规律；电势分布在极板间梯度合理，符合平行板电容器电场电势的预期特征。

## 4. 问题与收获

### 4.1 主要问题

初始编写代码时，迭代不收敛，排查发现是边界条件和极板区域判断逻辑有误，导致迭代更新时错误处理了边界或极板点。

电荷密度计算结果出现异常（如数值过大或过小），后来发现是拉普拉斯算子计算时网格间距处理不当。

### 4.2 解决方法

对于迭代不收敛问题，仔细检查导体掩码和边界条件的逻辑，重新梳理极板和边界的索引范围，确保非导体内部点才进行迭代更新。

针对电荷密度计算异常，重新推导泊松方程与拉普拉斯算子、网格间距的关系，修正代码中拉普拉斯算子计算时的网格间距处理，确保公式rho = -laplacian_U / (4 * np.pi)中拉普拉斯算子计算正确（结合dx等网格间距参数 ）。

### 4.3 主要收获

掌握了 SOR 迭代法求解拉普拉斯方程的具体实现，理解其通过松弛因子加速收敛的原理。

学会了如何将静电学物理问题（有限厚平行板电容器）转化为数值计算问题，包括边界条件设置、网格离散化等。

提升了代码调试能力，尤其是处理数值计算中收敛性问题和物理量计算准确性问题的能力，加深了对静电场中电势、电荷分布等物理概念的理解。

## 5. 思考题（可选）

### 5.1 松弛因子影响分析

松弛因子ω在 (1, 2) 范围内时，适当增大ω（如从 1.1 增大到 1.9 ），收敛速度加快。因为ω越大，每次迭代对当前点电势更新的调整幅度越大，能更快地向收敛解逼近；但ω不能超过 2，否则会导致迭代发散，无法收敛到正确解。当ω = 1时，就是普通的高斯 - 赛德尔迭代，收敛速度相对较慢。

### 5.2 有限厚度效应

理想薄板电容器中，极板厚度为 0，电荷集中在极板表面，电场在极板间（忽略边缘效应）近似均匀。而有限厚度极板电容器，电荷会分布在极板的两个表面（厚度方向的两个面），且在极板边缘，电荷密度会更集中（边缘效应更显著 ），导致极板间电场在边缘区域不再均匀，与理想薄板情况相比，电场分布的均匀性被破坏，电势分布也会在边缘出现更明显的变化。

### 5.3 数值精度讨论

网格分辨率（nx、ny大小）越高，计算精度越高，因为更细密的网格能更准确地刻画电势和电荷密度的分布细节，尤其是在极板边缘等梯度变化大的区域。但同时，计算效率会降低，因为网格点数量增加，迭代次数和计算量都会显著上升。实际应用中，需要根据具体需求平衡精度与计算效率，如对于初步分析，可采用较粗的网格快速得到大致结果；对于精确研究，则需提高网格分辨率，但要考虑计算资源和时间成本 。
